import java.io.File;

import jxl.Cell;
import jxl.Sheet;
import jxl.Workbook;
import java.io.File; 
import java.util.Date; 
import jxl.*; 

import java.io.File;
import java.io.IOException;
import jxl.Cell;
import jxl.CellType;
import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;

import com.thoughtworks.selenium.*;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import java.util.regex.Pattern;
import java.util.Locale;
import java.util.Random;
import java.io.*;
import java.lang.*;
import jxl.Cell;
import jxl.Sheet;
import jxl.Workbook;

import jxl.WorkbookSettings;
import jxl.write.Number;
import jxl.write.*;


public class GetVal extends SeleniumLib {
	@Before
	public void setUp() throws Exception {
		//selenium = new DefaultSelenium("localhost", 4444, "*chrome", "http://www.yatra.com/");
		//selenium.start();
	}

	@Test
	public void testGetVal() throws Exception {
		
	}
	public static boolean KillEXCELProcess() throws IOException{
		Runtime.getRuntime().exec("taskkill /F /IM excel.exe");
		return false;
		}

	public static String Method_GetNumberOfRowsCount(String path){
		boolean opvar = false;
		String ret_mess,mess="";
		int opvars;
			int col_locstr=0;
			try{
				
				KillEXCELProcess();  
					Workbook workbook = Workbook.getWorkbook(new File(path));
					
						Sheet sheet = workbook.getSheet(0);
	
							int	col_count = sheet.getRows();
							
							int val = col_count;
							
								opvars=val;
								opvar = true;
								mess = "Get the value from excel sheet is successfully";
								
				
				ret_mess="<KeywordOutput><Result><![CDATA["+val+"]]></Result><Status><![CDATA["+opvar+"]]></Status><Message><![CDATA["+mess+"]]></Message></KeywordOutput>";
						
			
	
	
	}catch(Exception e){
	opvar = false;
	mess = e.getMessage();
	ret_mess="<KeywordOutput><Result><![CDATA["+opvar+"]]></Result><Status><![CDATA["+opvar+"]]></Status><Message><![CDATA["+mess+"]]></Message></KeywordOutput>";
	e.printStackTrace();
	}
	return ret_mess;

	}
	public static String Method_GetValueFromExcelFileUsingColumnNumber(String path,int columnnumber,int rowno){
		boolean opvar = false;
		String ret_mess,mess="",opvars;
			int col_locstr=0;
			try{
				 KillEXCELProcess();  
				//HSFWorkbook workbook = new HSSFWorkbook(new FileInputStream(fileToBeRead));
				
					Workbook workbook = Workbook.getWorkbook(new File(path));
					
						Sheet sheet = workbook.getSheet(0);
	
							int	col_count = sheet.getColumns();
							columnnumber = columnnumber -1;
							rowno = rowno -1;
							
								Cell a1 = sheet.getCell(columnnumber,rowno); 
								String val = a1.getContents();
							
								opvars=val;
								opvar = true;
								mess = "Get the value from excel sheet is successfully";
								
				
				ret_mess="<KeywordOutput><Result><![CDATA["+val+"]]></Result><Status><![CDATA["+opvar+"]]></Status><Message><![CDATA["+mess+"]]></Message></KeywordOutput>";
						
			
	
	
	}catch(Exception e){
	opvar = false;
	mess = e.getMessage();
	ret_mess="<KeywordOutput><Result><![CDATA["+opvar+"]]></Result><Status><![CDATA["+opvar+"]]></Status><Message><![CDATA["+mess+"]]></Message></KeywordOutput>";
	e.printStackTrace();
	}
	return ret_mess;

	}
}
